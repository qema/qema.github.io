<!DOCTYPE html>
<html>
  <head>
    <title>nanosite - documentation</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="http://wanganzhou.com/nanosite/scripts/highlight/highlight.css">
    <script src="http://wanganzhou.com/nanosite/scripts/highlight/highlight.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    
    <link rel="stylesheet" href="http://wanganzhou.com/nanosite/style.css">
  </head>
  <body>
    <header>
      <h1><a href="http://wanganzhou.com/nanosite/index.html">nanosite</a></h1>
      <nav>
	<ul>
	  <li><a href="http://wanganzhou.com/nanosite/tutorial.html">Tutorial</a></li><li><a href="http://wanganzhou.com/nanosite/doc/index.html">Documentation</a></li><li><a href="http://wanganzhou.com/nanosite/packages.html">Packages</a></li><li><a href="http://wanganzhou.com/nanosite/download.html">Download</a></li>
	</ul>
      </nav>
    </header>
    
<h2>documentation</h2>


<article>
  <p>

<ul>
  <li><a href="http://wanganzhou.com/nanosite/doc/templates.html">template language</a></li>
  <li><a href="http://wanganzhou.com/nanosite/doc/site-generation.html">site generation</a></li>
  <li><a href="http://wanganzhou.com/nanosite/doc/packages.html">packages</a></li>
</ul>

</p>
<h1>packages</h1>
<p>Calling <code>nanosite import [name]</code> will import a package.
If <code>[name]</code> isn't already in the <code>.nanosite</code> file's <code>installed-packages</code> array:</p>
<ol>
<li>Search for package file<ol>
<li>Check <code>[name].zip</code> in top-level of site directory</li>
<li>Check <code>[package-url]/[name].zip</code> where <code>[package-url]</code> is the value of the "package-url" entry in the site's <code>.nanosite</code> file. Download this to site root.</li>
</ol>
</li>
<li>Install package<ol>
<li>Open <code>rules.json</code> in <code>[name].zip</code>. It should be a dictionary <code>{}</code>. Call it <code>rules</code>.</li>
<li>Install dependencies: go through the import routine for each list item (dependency name) in <code>rules["dependencies"]</code>.</li>
<li>For each key (filename) in <code>rules["files"]</code>, call its corresponding value <code>rule</code>. Get the destination path <code>dest</code> by compiling <code>rule["dest"]</code> against the default context (specifically with <code>OutputDir</code> and <code>MetaDir</code> entries). <code>dest</code> should be relative to the site top directory. Open <code>dest</code> with file mode <code>rule["action"]</code> (<code>"a"</code> for append, <code>"w"</code> for write) and write the contents of the file from <code>[name].zip</code>.</li>
</ol>
</li>
<li>Finalize<ol>
<li>Add <code>[name]</code> to the array in the <code>.nanosite</code> file's <code>installed-packages</code> entry</li>
<li>Delete <code>[name].zip</code> if downloaded from <code>[package-url]</code></li>
</ol>
</li>
</ol>
<h1>rules.json</h1>
<pre><code>{
  "files": {
    "[filename1.ext]": {"dest": [destination-path], "action": "[a or w]"},
    ...
  },
  "dependencies": [
    "[dependency-name-1]", ...
  ]
}
</code></pre>
</article>

    <footer>
      <div><small>Copyright Andrew Wang. Powered by <a href="http://wanganzhou.com/nanosite/index.html">nanosite</a>.</small></div>
    </footer>
  </body>
  
</html>


